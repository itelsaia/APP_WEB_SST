<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SaaS SST - Control de Campo</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --color-primario: #C5A048;
            --color-acento: #D4AF37;
            --color-fondo: #101922;
        }

        .bg-primary {
            background-color: var(--color-primario);
        }

        .text-primary {
            color: var(--color-primario);
        }

        .border-primary {
            border-color: var(--color-primario);
        }

        .bg-accent {
            background-color: var(--color-acento);
        }

        .text-accent {
            color: var(--color-acento);
        }

        .ring-primary {
            --tw-ring-color: var(--color-primario);
        }

        body {
            font-family: 'Inter', sans-serif;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse-glow {

            0%,
            100% {
                box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4);
            }

            50% {
                box-shadow: 0 0 20px 6px rgba(245, 158, 11, 0.15);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }

        .animate-slide-up {
            animation: slideUp 0.5s ease-out forwards;
        }

        .animate-pulse-glow {
            animation: pulse-glow 2s ease-in-out infinite;
        }

        /* Custom focus ring */
        .field-focus:focus {
            border-color: var(--color-primario);
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
        }
    </style>
</head>

<body class="bg-[#101922] min-h-screen flex flex-col text-slate-100 dark">

    <!-- Fondos decorativos difuminados -->
    <div
        class="fixed top-[-20%] right-[-10%] w-[400px] h-[400px] bg-[#C5A048]/10 rounded-full blur-[100px] pointer-events-none z-0">
    </div>
    <div
        class="fixed bottom-[-10%] left-[-20%] w-[300px] h-[300px] bg-[#C5A048]/5 rounded-full blur-[80px] pointer-events-none z-0">
    </div>

    <!-- CONFIG INYECTADA POR EL SERVIDOR -->
    <script>
        var SERVER_CONFIG = {};
        var SERVER_ROLE = '';
        var SERVER_EMAIL = '';
        var SERVER_URL = '';
        try {
            SERVER_CONFIG = <?!= configJSON || '{}' ?>;
            SERVER_ROLE = '<?= role || "" ?>';
            SERVER_EMAIL = '<?= email || "" ?>';
            SERVER_URL = '<?= scriptUrl || "" ?>';
        } catch (e) {
            console.error('[SST] Error parseando config del servidor:', e);
        }

        if (SERVER_CONFIG.COLOR_FONDO) {
            document.documentElement.style.setProperty('--color-fondo', SERVER_CONFIG.COLOR_FONDO);
        }

        console.log('[SST] P√°gina cargada. Rol:', SERVER_ROLE, 'Email:', SERVER_EMAIL);
    </script>

    <!-- Capa de Carga Inicial -->
    <div id="initial-loader" class="fixed inset-0 bg-[#101922] z-50 flex flex-col items-center justify-center"
        style="transition: opacity 0.5s ease;">
        <div class="animate-spin rounded-full h-16 w-16 mb-4"
            style="border: 4px solid rgba(197, 160, 72, 0.1); border-top-color: var(--color-primario);"></div>
        <p class="text-gray-400 font-medium tracking-tight">Verificando sesi√≥n segura...</p>
    </div>
    <script>
        setTimeout(function () {
            var loader = document.getElementById('initial-loader');
            if (loader) {
                loader.style.opacity = '0';
                setTimeout(function () { if (loader.parentNode) loader.parentNode.removeChild(loader); }, 600);
                console.warn('[SST] Loader eliminado por timeout de seguridad (8s)');
            }
        }, 8000);
    </script>

    <!-- Header compacto -->
    <header
        class="bg-[#101922]/80 backdrop-blur-md sticky top-0 z-40 px-4 py-3 flex justify-between items-center border-b border-white/10">
        <div class="flex items-center space-x-3">
            <span id="logo-marca-icon" class="material-symbols-outlined text-primary text-3xl">security</span>
            <img id="logo-marca" src="" alt="Logo"
                class="h-10 w-auto object-contain hidden border border-white/10 rounded-lg p-0.5">
            <div>
                <h1 class="text-base font-bold text-white leading-tight">Sistema SST</h1>
                <p class="text-[10px] text-primary font-bold uppercase tracking-widest">CONTROL DE CAMPO</p>
            </div>
        </div>
        <div id="user-info" class="hidden flex items-center space-x-2 text-sm text-white">
            <div class="text-right">
                <p id="user-name" class="font-bold text-white text-sm leading-none">...</p>
                <p id="user-role-label" class="text-[9px] text-primary font-bold uppercase tracking-wider mt-0.5">
                </p>
            </div>
            <div class="flex items-center space-x-3">
                <div class="w-9 h-9 bg-primary/20 rounded-xl flex items-center justify-center border border-primary/20">
                    <span class="material-symbols-outlined text-primary text-xl">person</span>
                </div>
                <button onclick="cerrarSesion()"
                    class="w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center text-primary hover:bg-primary hover:text-black transition-all shadow-sm border border-primary/20"
                    title="Cerrar Sesi√≥n">
                    <span class="material-symbols-outlined text-sm">logout</span>
                </button>
            </div>
        </div>
        <span id="user-email" class="hidden"></span>
    </header>
    <script>
        (function () {
            var rawUrl = SERVER_CONFIG.URL_LOGO || '';
            var logoImg = document.getElementById('logo-marca');
            var logoIcon = document.getElementById('logo-marca-icon');
            if (!rawUrl || rawUrl.indexOf('placeholder') !== -1) return;

            if (logoImg) {
                // Extraer ID de Drive para usar thumbnail (m√°s confiable)
                var driveMatch = rawUrl.match(/\/d\/([a-zA-Z0-9_-]+)/);
                var driveId = driveMatch ? driveMatch[1] : null;
                var firstUrl = driveId
                    ? 'https://drive.google.com/thumbnail?id=' + driveId + '&sz=w120'
                    : rawUrl;

                logoImg.setAttribute('data-raw-url', rawUrl);
                logoImg.setAttribute('data-drive-id', driveId || '');
                logoImg.setAttribute('data-retry', '0');
                logoImg.src = firstUrl;
                logoImg.classList.remove('hidden');

                logoImg.onerror = function () {
                    var img = this;
                    var id = img.getAttribute('data-drive-id');
                    var raw = img.getAttribute('data-raw-url') || '';
                    var retry = parseInt(img.getAttribute('data-retry') || '0');
                    img.setAttribute('data-retry', retry + 1);
                    if (retry === 0 && id) { img.src = 'https://drive.google.com/uc?export=view&id=' + id; }
                    else if (retry === 1 && id) { img.src = 'https://lh3.googleusercontent.com/d/' + id; }
                    else if (retry === 2) { img.src = raw; }
                    else {
                        img.classList.add('hidden');
                        if (logoIcon) logoIcon.classList.remove('hidden');
                    }
                };
                if (logoIcon) logoIcon.classList.add('hidden');
            }
        })();
    </script>

    <!-- Bienvenida compacta (visible solo en desktop / pantallas grandes) -->
    <header id="welcome-section" class="max-w-2xl mx-auto px-4 pt-4 pb-1 hidden z-10 relative">
        <div
            class="hidden md:flex bg-white/5 backdrop-blur-xl rounded-xl border border-white/10 px-5 py-4 items-center gap-4 animate-fade-in">
            <div
                class="w-12 h-12 bg-primary/15 rounded-2xl flex items-center justify-center shrink-0 border border-primary/20">
                <span id="welcome-icon" class="material-symbols-outlined text-3xl text-primary">waving_hand</span>
            </div>
            <div>
                <h2 id="welcome-message" class="text-lg font-black text-white tracking-tight">¬°Cargando...!</h2>
                <p id="welcome-subtext" class="text-slate-400 text-xs font-medium italic">Preparando su entorno...</p>
            </div>
        </div>
        <!-- Mobile: saludo inline m√≠nimo -->
        <div class="md:hidden px-1 pb-1">
            <p class="text-sm font-bold" style="color: var(--color-primario);"><span
                    id="welcome-message-mobile">Bienvenido/a</span> üëã</p>
        </div>
    </header>

    <!-- Contenedor Principal -->
    <main class="flex-grow p-4 container mx-auto max-w-2xl">

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- M√ìDULO DE ASISTENCIA ‚Äî INICIO DE JORNADA       -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div id="asistencia-content" class="hidden animate-slide-up">
            <div class="max-w-md mx-auto">
                <!-- Card principal ‚Äî dise√±o mobile-first compacto -->
                <div class="bg-white/5 backdrop-blur-xl rounded-2xl shadow-2xl overflow-hidden border border-white/10">

                    <!-- Banner superior compacto (minimal en mobile) -->
                    <div class="px-5 py-4 flex items-center gap-3 border-b border-primary/10"
                        style="background: linear-gradient(135deg,#1A1A1A,#101922);">
                        <div
                            class="w-10 h-10 bg-primary/10 rounded-xl flex items-center justify-center border border-primary/30 shrink-0">
                            <span class="material-symbols-outlined text-2xl text-primary">engineering</span>
                        </div>
                        <div>
                            <h3 class="text-sm font-black uppercase tracking-tight text-white leading-none">Inicio de
                                Jornada</h3>
                            <p class="text-[9px] text-slate-400 font-bold uppercase tracking-widest mt-0.5">Registre su
                                ingreso</p>
                        </div>
                    </div>

                    <!-- Formulario compacto para mobile -->
                    <div class="p-4 space-y-3">
                        <form id="attendance-form" class="space-y-3">
                            <!-- Campo 1: Obra -->
                            <div>
                                <label
                                    class="flex items-center text-[10px] font-bold text-gray-500 uppercase tracking-wider mb-1.5">
                                    <span class="material-symbols-outlined text-sm mr-1 text-primary">location_on</span>
                                    Obra / Proyecto
                                </label>
                                <select id="idObraAsistencia" required
                                    style="background-color:#1a242f; color:#f8fafc; color-scheme: dark;"
                                    class="w-full px-3 py-3 border border-white/10 rounded-xl outline-none text-sm font-medium appearance-none cursor-pointer transition-all"
                                    onfocus="this.style.borderColor='var(--color-primario)'"
                                    onblur="this.style.borderColor='rgba(255,255,255,0.1)'">
                                    <option value="" style="background:#1a242f; color:#f8fafc;">Seleccione ubicaci√≥n...
                                    </option>
                                </select>
                            </div>

                            <!-- Campo 2: Foto (compacto) -->
                            <div>
                                <label
                                    class="flex items-center text-[10px] font-bold text-gray-500 uppercase tracking-wider mb-1.5">
                                    <span
                                        class="material-symbols-outlined text-sm mr-1 text-primary">photo_camera</span>
                                    Evidencia Fotogr√°fica
                                </label>

                                <div id="asis-preview-container"
                                    class="hidden mb-2 rounded-xl overflow-hidden shadow-md border-2 border-primary/20 relative"
                                    style="max-height: 140px;">
                                    <img id="asis-img-preview" src="" alt="Soporte" class="w-full h-full object-cover">
                                    <div
                                        class="absolute bottom-1.5 right-1.5 bg-primary text-black text-[9px] font-black px-2 py-0.5 rounded-full flex items-center shadow-lg">
                                        <span class="material-symbols-outlined text-[10px] mr-0.5">check_circle</span>
                                        CAPTURADA
                                    </div>
                                </div>

                                <label for="asis-foto" id="asis-foto-label"
                                    class="cursor-pointer border-2 border-dashed border-white/10 rounded-xl py-4 flex flex-col items-center hover:border-primary/50 hover:bg-white/5 transition-all group">
                                    <div
                                        class="bg-primary/10 p-2.5 rounded-full group-hover:scale-110 transition-transform border border-primary/20">
                                        <span class="material-symbols-outlined text-2xl text-primary">add_a_photo</span>
                                    </div>
                                    <span class="mt-1.5 text-[11px] font-semibold text-slate-400">Toque para capturar
                                        selfie</span>
                                    <input type="file" id="asis-foto" accept="image/*" capture="camera" class="hidden"
                                        onchange="previewAsistencia(this)">
                                </label>
                            </div>

                            <!-- Bot√≥n de acci√≥n -->
                            <button type="submit" id="btn-asistencia"
                                style="background: var(--color-primario); box-shadow: 0 6px 20px rgba(197,160,72,0.25);"
                                class="w-full hover:opacity-90 text-black font-black py-3.5 rounded-xl text-sm active:scale-[0.98] transition-all flex justify-center items-center gap-2 uppercase tracking-widest mt-1">
                                <span id="asis-spinner"
                                    class="hidden animate-spin border-2 border-black border-t-transparent rounded-full w-4 h-4"></span>
                                <span class="material-symbols-outlined text-lg" id="asis-btn-icon">login</span>
                                <span id="asis-btn-text">INICIAR JORNADA</span>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Banner de jornada activa + bot√≥n salida (Independiente) -->
        <div id="exit-section"
            class="hidden mb-6 rounded-2xl overflow-hidden glass-card shadow-2xl animate-pulse-glow max-w-2xl mx-auto border-primary/20">
            <div
                class="bg-gradient-to-r from-primary/20 to-primary/5 px-4 py-3 flex items-center justify-between backdrop-blur-md">
                <div class="flex items-center space-x-3">
                    <div class="bg-primary/20 p-2 rounded-xl border border-primary/30">
                        <span class="material-symbols-outlined text-primary text-xl">schedule</span>
                    </div>
                    <div>
                        <p class="text-sm font-black text-white uppercase tracking-tighter">Jornada Activa</p>
                        <p class="text-[10px] text-slate-400 font-bold uppercase tracking-widest">Registre su salida al
                            finalizar</p>
                    </div>
                </div>
                <button onclick="openExitModal()"
                    class="bg-primary text-black hover:opacity-90 px-5 py-2.5 rounded-xl font-black shadow-lg shadow-primary/20 transition-all active:scale-95 flex items-center text-xs uppercase tracking-widest ml-3">
                    <span class="material-symbols-outlined mr-1.5 text-base">logout</span>
                    Finalizar
                </button>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- PANEL DE TRABAJO (main-content)                -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div id="main-content" class="hidden animate-slide-up">
            <!-- Contenido del panel (se inyecta por JS seg√∫n rol) -->
            <div class="bg-white/5 backdrop-blur-xl rounded-2xl shadow-2xl p-6 border border-white/10">
                <div id="content-placeholder" class="text-center py-8 text-slate-500">
                    <span class="material-symbols-outlined text-4xl mb-2 text-primary">hourglass_top</span>
                    <p class="text-sm font-medium">Cargando m√≥dulo seguro...</p>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- MODAL DE SALIDA                                -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div id="exit-modal"
            class="fixed inset-0 bg-black/80 z-[60] flex items-end sm:items-center justify-center hidden backdrop-blur-md"
            onclick="if(event.target===this) closeExitModal()">
            <div
                class="bg-[#101922] rounded-t-3xl sm:rounded-2xl shadow-2xl w-full sm:max-w-md overflow-hidden animate-slide-up border border-white/10">
                <!-- Handle bar (mobile) -->
                <div class="sm:hidden flex justify-center pt-3 pb-1">
                    <div class="w-10 h-1 bg-white/20 rounded-full"></div>
                </div>

                <!-- Header del modal -->
                <div class="px-6 pt-5 pb-4 text-center">
                    <div
                        class="inline-flex items-center justify-center w-14 h-14 bg-primary/10 rounded-2xl mb-3 border border-primary/20">
                        <span class="material-symbols-outlined text-3xl text-primary">waving_hand</span>
                    </div>
                    <h3 class="text-xl font-bold text-white tracking-tight">Finalizar Jornada</h3>
                    <p class="text-slate-400 text-sm mt-1 font-medium italic">Capture su foto de salida para concluir
                    </p>
                </div>

                <div class="px-6 pb-6">
                    <!-- Preview de la foto capturada -->
                    <div id="exit-preview-container"
                        class="hidden mb-4 rounded-xl overflow-hidden shadow-2xl border-2 border-primary/30 relative aspect-video">
                        <img id="exit-img-preview" src="" class="w-full h-full object-cover">
                        <div
                            class="absolute bottom-2 right-2 bg-green-500 text-white text-[10px] font-bold px-2 py-1 rounded-full flex items-center">
                            <span class="material-symbols-outlined text-xs mr-0.5">check_circle</span> Lista
                        </div>
                    </div>

                    <!-- Bot√≥n de captura -->
                    <label for="exit-foto" id="exit-foto-label"
                        class="cursor-pointer border-2 border-dashed border-white/10 rounded-xl p-5 flex flex-col items-center hover:border-primary/50 hover:bg-white/5 transition-all group mb-5">
                        <div
                            class="bg-primary/10 p-3 rounded-full group-hover:scale-110 transition-transform border border-primary/20">
                            <span class="material-symbols-outlined text-2xl text-primary">add_a_photo</span>
                        </div>
                        <span class="mt-2 text-xs font-bold text-slate-400 uppercase tracking-widest">Toque para
                            capturar</span>
                        <input type="file" id="exit-foto" accept="image/*" capture="camera" class="hidden"
                            onchange="previewSalida(this)">
                    </label>

                    <!-- Botones de acci√≥n -->
                    <div class="flex space-x-3">
                        <button onclick="closeExitModal()"
                            class="flex-1 py-3.5 text-slate-300 font-bold hover:bg-white/5 rounded-xl transition text-sm border border-white/10">Cancelar</button>
                        <button onclick="submitSalida()" id="btn-submit-salida"
                            class="flex-1 py-3.5 bg-primary text-black font-black rounded-xl shadow-lg shadow-primary/20 hover:opacity-90 transition-all active:scale-[0.98] flex items-center justify-center text-sm uppercase tracking-widest">
                            <span id="exit-spinner"
                                class="hidden animate-spin mr-2 border-2 border-black border-t-transparent rounded-full w-4 h-4"></span>
                            <span class="material-symbols-outlined text-base mr-1">logout</span>
                            Confirmar Salida
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- CONTENIDO CONDICIONAL SEG√öN ROL (templates ocultos) -->
    <template id="tpl-inspeccion">
        <?!= include('FormInspeccion'); ?>
    </template>
    <template id="tpl-admin">
        <!-- ‚ïê‚ïê PORTAL DE M√ìDULOS (visible al entrar) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div id="admin-portal" class="space-y-4 animate-fade-in">
            <!-- Cabecera del portal -->
            <div class="border-b border-white/10 pb-4">
                <div class="flex items-center gap-3 mb-1">
                    <div
                        class="w-9 h-9 bg-primary/10 border border-primary/20 rounded-xl flex items-center justify-center shrink-0">
                        <span class="material-symbols-outlined text-xl text-primary">admin_panel_settings</span>
                    </div>
                    <div>
                        <h3 class="text-sm font-black text-white uppercase tracking-tight">Portal de Administraci√≥n</h3>
                        <p class="text-[9px] text-slate-500 font-bold uppercase tracking-widest">Seleccione un m√≥dulo
                        </p>
                    </div>
                </div>
            </div>
            <!-- Cuadr√≠cula de m√≥dulos -->
            <div class="grid grid-cols-2 gap-3">
                <!-- M√≥dulo activo: Gesti√≥n de Empresas -->
                <button onclick="abrirModuloAdmin('clientes')"
                    class="group flex flex-col items-center justify-center gap-2.5 p-5 bg-white/5 hover:bg-white/10 border border-white/10 hover:border-primary/40 rounded-2xl transition-all active:scale-95 text-center">
                    <div
                        class="w-12 h-12 bg-primary/10 border border-primary/20 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform">
                        <span class="material-symbols-outlined text-2xl text-primary">domain</span>
                    </div>
                    <div>
                        <p class="text-xs font-black text-white uppercase tracking-tight leading-none">Empresas</p>
                        <p class="text-[9px] text-slate-500 font-bold mt-0.5">Gesti√≥n de Clientes</p>
                    </div>
                </button>
                <!-- M√≥dulo futuro: Usuarios -->
                <div
                    class="flex flex-col items-center justify-center gap-2.5 p-5 bg-white/3 border border-white/5 rounded-2xl opacity-35 cursor-not-allowed text-center">
                    <div
                        class="w-12 h-12 bg-slate-500/10 border border-slate-500/20 rounded-xl flex items-center justify-center">
                        <span class="material-symbols-outlined text-2xl text-slate-500">group</span>
                    </div>
                    <div>
                        <p class="text-xs font-black text-slate-500 uppercase tracking-tight leading-none">Usuarios</p>
                        <p class="text-[9px] text-slate-600 font-bold mt-0.5">Pr√≥ximamente</p>
                    </div>
                </div>
                <!-- M√≥dulo futuro: Reportes -->
                <div
                    class="flex flex-col items-center justify-center gap-2.5 p-5 bg-white/3 border border-white/5 rounded-2xl opacity-35 cursor-not-allowed text-center">
                    <div
                        class="w-12 h-12 bg-slate-500/10 border border-slate-500/20 rounded-xl flex items-center justify-center">
                        <span class="material-symbols-outlined text-2xl text-slate-500">bar_chart</span>
                    </div>
                    <div>
                        <p class="text-xs font-black text-slate-500 uppercase tracking-tight leading-none">Reportes</p>
                        <p class="text-[9px] text-slate-600 font-bold mt-0.5">Pr√≥ximamente</p>
                    </div>
                </div>
                <!-- M√≥dulo futuro: Configuraci√≥n -->
                <div
                    class="flex flex-col items-center justify-center gap-2.5 p-5 bg-white/3 border border-white/5 rounded-2xl opacity-35 cursor-not-allowed text-center">
                    <div
                        class="w-12 h-12 bg-slate-500/10 border border-slate-500/20 rounded-xl flex items-center justify-center">
                        <span class="material-symbols-outlined text-2xl text-slate-500">settings</span>
                    </div>
                    <div>
                        <p class="text-xs font-black text-slate-500 uppercase tracking-tight leading-none">Configuraci√≥n
                        </p>
                        <p class="text-[9px] text-slate-600 font-bold mt-0.5">Pr√≥ximamente</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê WORKSPACE: GESTI√ìN DE CLIENTES (oculto inicialmente) ‚ïê‚ïê -->
        <div id="admin-workspace-clientes" class="hidden">
            <?!= include('AdminClientes'); ?>
        </div>
    </template>
    <template id="tpl-error">
        <div class="text-center py-10">
            <span class="material-symbols-outlined text-6xl text-red-400 mb-4">error</span>
            <p class="text-red-500 text-lg font-bold">Rol no reconocido o acceso no autorizado.</p>
            <a id="error-login-link" href="#" class="text-primary underline mt-4 inline-block">Volver al Login</a>
        </div>
    </template>

    <script>
        // Inyectar contenido seg√∫n rol del servidor
        (function () {
            var mainContent = document.getElementById('main-content');
            var placeholder = document.getElementById('content-placeholder');
            var tplId = '';

            if (SERVER_ROLE === 'SUP-SST') {
                tplId = 'tpl-inspeccion';
            } else if (SERVER_ROLE === 'ADMIN') {
                tplId = 'tpl-admin';
            } else {
                tplId = 'tpl-error';
            }

            var tpl = document.getElementById(tplId);
            if (tpl && mainContent) {
                // Buscamos cualquier contenedor que tenga backdrop-blur-xl (nuestra nueva clase global)
                var contentDiv = mainContent.querySelector('.backdrop-blur-xl');
                if (contentDiv) {
                    contentDiv.innerHTML = tpl.innerHTML;
                } else {
                    mainContent.innerHTML = '<div class="bg-white/5 backdrop-blur-xl rounded-2xl shadow-2xl p-6 border border-white/10">' + tpl.innerHTML + '</div>';
                }
                var loginLink = document.getElementById('error-login-link');
                if (loginLink && SERVER_URL) {
                    loginLink.href = SERVER_URL;
                }
            }
            console.log('[SST] Contenido cargado para rol:', SERVER_ROLE);
        })();
    </script>

    <!-- L√≥gica principal del cliente -->
    <?!= include('App.js'); ?>

    <!-- Footer -->
    <footer
        class="bg-[#101922]/90 backdrop-blur-md text-white p-6 text-center text-[10px] mt-auto border-t border-white/5">
        <p class="font-bold uppercase tracking-[0.2em] text-slate-500 mb-1">Desarrollado por ITELSA IA</p>
        <p class="text-primary font-bold">Powered by Google Cloud & Gemini AI</p>
    </footer>

</body>

</html>